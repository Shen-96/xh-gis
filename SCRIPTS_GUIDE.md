# XH-GIS è„šæœ¬ä½¿ç”¨æŒ‡å—

## ğŸ“¦ è„šæœ¬æ¦‚è§ˆ

é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒè„šæœ¬ï¼Œæ”¯æŒä¸€é”®å‘å¸ƒåŠŸèƒ½ã€‚

### ğŸ¯ ä¸»è¦è„šæœ¬

| è„šæœ¬æ–‡ä»¶ | åŠŸèƒ½ | æ¨èä½¿ç”¨ | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|----------|
| `release.sh` | ğŸš€ **ä¸€é”®å‘å¸ƒ** (ç‰ˆæœ¬ç®¡ç†+æ„å»º+å‘å¸ƒ) | â­â­â­â­â­ | æ—¥å¸¸å‘å¸ƒã€æ–°æ‰‹ä½¿ç”¨ |
| `version.sh` | ğŸ“ ç‰ˆæœ¬ç®¡ç† (ç»Ÿä¸€æ›´æ–°ç‰ˆæœ¬å·) | â­â­â­â­ | å›¢é˜Ÿåä½œã€ç‰ˆæœ¬å‡†å¤‡ |
| `publish.sh` | ğŸ“¤ æ ‡å‡†å‘å¸ƒ (å‘å¸ƒåˆ°NPMå®˜æ–¹æº) | â­â­â­ | é‡æ–°å‘å¸ƒã€æ ‡ç­¾å‘å¸ƒ |
| `publish-cn.sh` | ğŸ‡¨ğŸ‡³ å›½å†…å‘å¸ƒ (å›½å†…ç¯å¢ƒä¼˜åŒ–) | â­â­â­ | å›½å†…ç¯å¢ƒå‘å¸ƒ |
| `test.sh` | ğŸ§ª æ„å»ºéªŒè¯ | â­â­ | æ„å»ºæµ‹è¯• |
| `registry.sh` | ğŸ”„ é•œåƒæºç®¡ç† | â­â­ | é•œåƒæºåˆ‡æ¢ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“ˆ æ¨èä½¿ç”¨ä¼˜å…ˆçº§

1. **ğŸ¥‡ é¦–é€‰ï¼šä¸€é”®å‘å¸ƒï¼ˆrelease.shï¼‰**
   - **é€‚ç”¨åœºæ™¯**: æ—¥å¸¸å‘å¸ƒã€æ–°æ‰‹ä½¿ç”¨ã€è¿½æ±‚æ•ˆç‡
   - **ä¼˜åŠ¿**: è‡ªåŠ¨åŒ–ç¨‹åº¦æœ€é«˜ï¼ŒåŒ…å«å®Œæ•´æµç¨‹
   ```bash
   # å‘å¸ƒè¡¥ä¸ç‰ˆæœ¬ï¼ˆæœ€å¸¸ç”¨ï¼‰
   ./release.sh patch
   
   # å‘å¸ƒæŒ‡å®šç‰ˆæœ¬
   ./release.sh 1.0.1
   
   # æ¨¡æ‹Ÿå‘å¸ƒï¼ˆæµ‹è¯•ï¼‰
   ./release.sh patch --dry-run
   
   # å›½å†…ç¯å¢ƒå‘å¸ƒ
   ./release.sh patch --china
   ```

2. **ğŸ¥ˆ å¤‡é€‰ï¼šåˆ†æ­¥æ“ä½œï¼ˆversion.sh + publish.shï¼‰**
   - **é€‚ç”¨åœºæ™¯**: éœ€è¦æµ‹è¯•éªŒè¯ã€å›¢é˜Ÿåä½œã€ç²¾ç¡®æ§åˆ¶
   - **ä¼˜åŠ¿**: çµæ´»æ€§é«˜ï¼Œå¯ä»¥åˆ†é˜¶æ®µæ‰§è¡Œ
   ```bash
   # åœºæ™¯ï¼šæƒ³å…ˆæ›´æ–°ç‰ˆæœ¬ï¼Œæµ‹è¯•åå†å‘å¸ƒ
   ./version.sh patch          # åªæ›´æ–°ç‰ˆæœ¬
   # ... è¿›è¡Œæµ‹è¯• ...
   ./publish.sh               # æ„å»ºå¹¶å‘å¸ƒ
   ```

3. **ğŸ¥‰ ç‰¹æ®Šï¼šå›½å†…ç”¨æˆ·ç›´æ¥å‘å¸ƒï¼ˆpublish-cn.shï¼‰**
   - **é€‚ç”¨åœºæ™¯**: å·²æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬ï¼Œåªéœ€å‘å¸ƒ
   - **ä¼˜åŠ¿**: é’ˆå¯¹å›½å†…ç¯å¢ƒä¼˜åŒ–
   ```bash
   # å¦‚æœå·²ç»æ‰‹åŠ¨æ›´æ–°äº†ç‰ˆæœ¬ï¼Œæƒ³ç›´æ¥å‘å¸ƒ
   ./publish-cn.sh
   ```

### ğŸ¯ æ¨èä½¿ç”¨æµç¨‹

#### æ–°æ‰‹æ¨èï¼ˆä¸€é”®å‘å¸ƒï¼‰

```bash
# å‘å¸ƒæŒ‡å®šç‰ˆæœ¬ (æ¨è)
./release.sh 1.0.2

# å‘å¸ƒè¡¥ä¸ç‰ˆæœ¬ (1.0.1 -> 1.0.2)
./release.sh patch

# å‘å¸ƒæ¬¡ç‰ˆæœ¬ (1.0.1 -> 1.1.0)
./release.sh minor

# å‘å¸ƒä¸»ç‰ˆæœ¬ (1.0.1 -> 2.0.0)
./release.sh major
```

#### ç»éªŒç”¨æˆ·æ¨èï¼ˆåˆ†æ­¥æ§åˆ¶ï¼‰

```bash
# 1. å…ˆæ›´æ–°ç‰ˆæœ¬
./version.sh 1.0.2

# 2. æµ‹è¯•æ„å»º
./test.sh

# 3. ç¡®è®¤æ— è¯¯åå‘å¸ƒ
./publish.sh
```

### ğŸ“ æ¨¡æ‹Ÿè¿è¡Œ (å»ºè®®å…ˆæµ‹è¯•)

```bash
# æ¨¡æ‹Ÿå‘å¸ƒï¼Œæ£€æŸ¥æµç¨‹
./release.sh 1.0.2 --dry-run

# æ¨¡æ‹Ÿè¡¥ä¸ç‰ˆæœ¬å‘å¸ƒ
./release.sh patch --dry-run
```

### ğŸ† ç‰¹æ®Šå‘å¸ƒéœ€æ±‚

```bash
# å‘å¸ƒ Beta ç‰ˆæœ¬
./release.sh 1.0.2-beta.1 --tag beta

# ä½¿ç”¨å›½å†…é•œåƒæºå‘å¸ƒ
./release.sh 1.0.2 --china

# è·³è¿‡æ„å»ºæ­¥éª¤ (å¦‚æœå·²ç»æ„å»ºè¿‡)
./release.sh 1.0.2 --skip-build
```

## ğŸ“‹ åˆ†æ­¥æ“ä½œ (ä¼ ç»Ÿæ–¹å¼)

å¦‚æœéœ€è¦åˆ†æ­¥æ§åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼š

### 1. ç‰ˆæœ¬ç®¡ç†

```bash
# æ›´æ–°åˆ°æŒ‡å®šç‰ˆæœ¬
./version.sh 1.0.2

# æ›´æ–°è¡¥ä¸ç‰ˆæœ¬
./version.sh patch

# æ¨¡æ‹Ÿè¿è¡Œç‰ˆæœ¬æ›´æ–°
./version.sh 1.0.2 --dry-run

# æ›´æ–°ç‰ˆæœ¬ä½†ä¸è‡ªåŠ¨æäº¤
./version.sh 1.0.2 --no-commit
```

### 2. æ„å»ºéªŒè¯

```bash
# éªŒè¯æ„å»ºæ˜¯å¦æ­£å¸¸
./test.sh
```

### 3. å‘å¸ƒåŒ…

```bash
# æ ‡å‡†å‘å¸ƒ (å›½é™…ç”¨æˆ·)
./publish.sh

# å›½å†…å‘å¸ƒ (å›½å†…ç”¨æˆ·)
./publish-cn.sh

# æ¨¡æ‹Ÿå‘å¸ƒ
./publish.sh --dry-run

# å‘å¸ƒåˆ°æŒ‡å®šæ ‡ç­¾
./publish.sh --tag beta
```

## ğŸ”§ é•œåƒæºç®¡ç†

```bash
# æŸ¥çœ‹å½“å‰é•œåƒæº
./registry.sh status

# åˆ‡æ¢åˆ°å›½å†…é•œåƒæº
./registry.sh china

# åˆ‡æ¢åˆ°å®˜æ–¹é•œåƒæº
./registry.sh official

# é‡ç½®é•œåƒæºé…ç½®
./registry.sh reset
```

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. é¦–æ¬¡å‘å¸ƒæµç¨‹

```bash
# 1. ç¡®ä¿ä»£ç å·²æäº¤
git add . && git commit -m "feat: ready for first release"

# 2. ä¸€é”®å‘å¸ƒ (æ¨è)
./release.sh 1.0.0

# æˆ–åˆ†æ­¥æ“ä½œ
./version.sh 1.0.0
./test.sh
./publish.sh
```

### 2. æ—¥å¸¸æ›´æ–°æµç¨‹

```bash
# ä¿®å¤Bug - è¡¥ä¸ç‰ˆæœ¬
./release.sh patch

# æ–°åŠŸèƒ½ - æ¬¡ç‰ˆæœ¬  
./release.sh minor

# é‡å¤§æ›´æ–° - ä¸»ç‰ˆæœ¬
./release.sh major
```

### 3. å›½å†…ç”¨æˆ·ä¼˜åŒ–

```bash
# ä½¿ç”¨å›½å†…é•œåƒæº + å‘å¸ƒ
./registry.sh china
./release.sh 1.0.2 --china
```

### 4. å›¢é˜Ÿåä½œ

```bash
# æ¨¡æ‹Ÿè¿è¡Œï¼Œç¡®è®¤æ— è¯¯
./release.sh 1.0.2 --dry-run

# ç¡®è®¤åæ­£å¼å‘å¸ƒ
./release.sh 1.0.2
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å‘å¸ƒå‰æ£€æŸ¥

- âœ… ç¡®ä¿æ‰€æœ‰ä»£ç å·²æäº¤
- âœ… ç¡®ä¿åœ¨ä¸»åˆ†æ”¯ (main/master)
- âœ… ç¡®ä¿å·²ç™»å½• NPM: `npm whoami`
- âœ… ç¡®ä¿ç‰ˆæœ¬å·ç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ

### 2. ç‰ˆæœ¬å·è§„èŒƒ

- `patch`: ä¿®å¤Bug (1.0.0 â†’ 1.0.1)
- `minor`: æ–°åŠŸèƒ½ (1.0.0 â†’ 1.1.0)
- `major`: é‡å¤§æ›´æ–° (1.0.0 â†’ 2.0.0)
- å…·ä½“ç‰ˆæœ¬: `1.2.3` æ ¼å¼

### 3. å‘å¸ƒæ ‡ç­¾

- `latest`: æ­£å¼ç‰ˆæœ¬ (é»˜è®¤)
- `beta`: æµ‹è¯•ç‰ˆæœ¬
- `alpha`: å¼€å‘ç‰ˆæœ¬
- è‡ªå®šä¹‰æ ‡ç­¾: å¦‚ `next`, `experimental`

### 4. å›½å†…ç”¨æˆ·æç¤º

å¦‚æœåœ¨å›½å†…ç¯å¢ƒï¼Œå»ºè®®ï¼š
1. ä½¿ç”¨ `./registry.sh china` åˆ‡æ¢é•œåƒæº
2. ä½¿ç”¨ `./release.sh <version> --china` å‘å¸ƒ

## ğŸ†˜ å¸¸è§é—®é¢˜

### 1. ç™»å½•é—®é¢˜

```bash
# æ£€æŸ¥ç™»å½•çŠ¶æ€
npm whoami

# ç™»å½• NPM
npm login

# å›½å†…ç”¨æˆ·ç™»å½•å®˜æ–¹æº
npm login --registry=https://registry.npmjs.org/
```

### 2. ç‰ˆæœ¬å·é—®é¢˜

```bash
# æ£€æŸ¥å½“å‰ç‰ˆæœ¬
cat package.json | grep version

# æŸ¥çœ‹ç‰ˆæœ¬å†å²
git tag --list

# åˆ é™¤é”™è¯¯çš„æ ‡ç­¾ (æœ¬åœ°)
git tag -d v1.0.1

# åˆ é™¤é”™è¯¯çš„æ ‡ç­¾ (è¿œç¨‹)
git push origin --delete v1.0.1
```

### 3. å·¥ä½œç›®å½•ä¸å¹²å‡€

```bash
# æŸ¥çœ‹æœªæäº¤çš„æ–‡ä»¶
git status

# æäº¤æ‰€æœ‰æ›´æ”¹
git add . && git commit -m "chore: prepare for release"

# æˆ–é‡ç½®æ›´æ”¹
git checkout .
```

### 4. æ„å»ºå¤±è´¥

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules packages/*/node_modules
pnpm install

# æ‰‹åŠ¨æ„å»ºæ£€æŸ¥
pnpm run build:packages
pnpm run build
```

## ğŸ“ è·å–å¸®åŠ©

æ¯ä¸ªè„šæœ¬éƒ½æ”¯æŒ `--help` å‚æ•°ï¼š

```bash
./release.sh --help
./version.sh --help
./publish.sh --help
```

---

ğŸ‰ ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ `./release.sh <version>` ä¸€é”®å‘å¸ƒ XH-GIS åŒ…äº†ï¼